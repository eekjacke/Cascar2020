# REVIEW FOR 2020

# Short Manual on CASCAR platform

This document presents some useful procedures and commands to use with the cascar platform.

## Network

Wifi hotspot is usually created automatically, named in format ```cascar_X```.
Password: _tsfs12autonom_

Connect to the hotspot with your laptop

Start the provided virtual machine

When you open a terminal window it should automatically set suitable environment variables.
If it fails, one reason could be network configuration.
Check IP address inside the VM

```bash
hostname -I
```

It should have an address of type ```192.168.0.X```.
If it not, try to restart network interface inside VM

```bash
sudo systemctl restart  NetworkManager.service
```

After that

```bash
source ~/.bashrc
```

## Initialize the car

To SSH the car

```bash
ssh $ROS_MASTER_IP
```

Run one of the lines to initialize the car (```roscore``` would start automatically if it is not running yet)

```bash
roslaunch cascar cascar.launch no lidar
roslaunch cascar cascar_lidar.launch with lidar
```

From inside VM

## Command line interface

To see the topics and check that ```/car_command``` topic is available

```bash
rostopic list
```

To publish a command to the car from the terminal

```bash
rostopic pub /car_command cascar/CarCommand "velocity: 50.0
steer: 0.0"
```

(typically problematic with spaces, works better just to type ```rostopic pub /car_command``` and then press ```Tab``` button several types to autocomplete the command)

In a separate window by running

```bash
rostopic echo /odom
```

you could see odometry messages published when the cars is moving

## ROS examples code

Two example scripts are provided with basic ROS functionality that can be used as starting points for you own development.

More general examples can be found at the [ROS wiki page](http://wiki.ros.org/ROS/Tutorials). In particular this [example](http://wiki.ros.org/ROS/Tutorials/WritingPublisherSubscriber%28python%29) is worth studying.

Both example scripts are within the __playground__ folder within the ROS workspace.

### cascar_test_node.py

Once executed, this script sends commands to the command with a particular frequency: ```cascar_test_node.py```

It is possible to run it as

```bash
python3 cascar_test_node.py
```

However, to make it to a “real” node, you need to make it executable

```bash
chmod +x  cascar_test_node.py
```

After that it should be possible to start the node by

```bash
rosrun cascar cascar_test_node.py
```

### lidar_reader.py

This example will give you some insight into how to manipulate the data generated by the RPlidar. 

The function is a follows: Once scans are available, each range recording is converted into a cartesian point that will provide information of obstacles in the vehicle's relative coordinate frame.

Execution of the lidar_reader node can be done in the same manner as described above.

There is plenty of information to be gathered from a scan message, more information can be found [here](http://docs.ros.org/api/sensor_msgs/html/msg/LaserScan.html).